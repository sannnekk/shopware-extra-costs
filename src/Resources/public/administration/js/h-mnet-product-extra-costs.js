!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/bundles/hmnetproductextracosts/",r(r.s="sbY5")}({sbY5:function(t,e,r){"use strict";r.r(e);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s=Shopware.Component.getComponentHelper().mapGetters;Shopware.Component.override("sw-product-detail",{template:'{% block sw_product_detail_content_tabs_reviews %}\n\n\t{% parent %}\n\n\t<sw-tabs-item :route="{ name: \'sw.product.detail.extracosts\', params: { id: $route.params.id } }" v-if="!this.isChild" title="Extra-Kosten">\n\t\tExtra-Kosten\n\t</sw-tabs-item>\n\n{% endblock %}\n',computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},s("swProductDetail",["isChild"]))});function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=Shopware.Data.Criteria,d=Shopware.Context,f=Shopware.Component.getComponentHelper(),m=f.mapState,y=f.mapGetters;Shopware.Component.register("sw-product-detail-extracosts",{template:'<sw-container columns="100%" rows="auto" v-if="!loading.product">\n\t<sw-container columns="100%" rows="auto">\n\t\t<sw-card title="Extra-Kosten">\n\t\t\t<sw-data-grid v-if="available" :is-loading="loading.product" :data-source="properties" :show-selection="false" :columns="columns" :allow-inline-edit="true" :compact-mode="true" style="margin: -30px">\n\n\t\t\t\t<template slot="column-option-name" slot-scope="{ item }">\n\t\t\t\t\t<b>{{ item.name }}:</b>\n\t\t\t\t\t<span>&nbsp;{{ item.value }}</span>\n\t\t\t\t</template>\n\n\t\t\t\t<template v-for="quantity in quantities" :key="quantity.id" :slot="`column-quantity-${quantity.id}`" slot-scope="{ item, compact }">\n\t\t\t\t\t<sw-field type="number" :size="compact ? \'small\' : \'default\'" v-model="item.prices[quantity.id]" @input-change="onInputChange"/>\n\t\t\t\t</template>\n\n\t\t\t\t<template slot="column-setup-cost" slot-scope="{ item, compact }">\n\t\t\t\t\t<sw-field type="number" :size="compact ? \'small\' : \'default\'" v-model="item.prices[\'setup-cost\']" @input-change="onInputChange"/>\n\t\t\t\t</template>\n\n\t\t\t\t<template slot="column-film-cost" slot-scope="{ item, compact }">\n\t\t\t\t\t<sw-field type="number" :size="compact ? \'small\' : \'default\'" v-model="item.prices[\'film-cost\']" @input-change="onInputChange"/>\n\t\t\t\t</template>\n\n\t\t\t</sw-data-grid>\n\t\t\t<p v-else>\n\t\t\t\t<b>Bitte fügen Sie erst die Varianten hinzu</b>\n\t\t\t</p>\n\t\t</sw-card>\n\t</sw-container>\n</sw-container>\n',inject:["repositoryFactory"],metaInfo:function(){return{title:"Extra-Kosten"}},data:function(){return{properties:[]}},computed:c(c({available:function(){var t;return(null===(t=this.product.configuratorSettings)||void 0===t?void 0:t.length)>0},columns:function(){var t={allowResize:!0,primary:!0,visible:!0,width:"110px",rawData:!1},e=[c({property:"option-name",label:"Ausprägungen"},t)];return this.quantities.forEach((function(r){return e.push(c({property:"quantity-".concat(r.id),label:"".concat(r.min," - ").concat(r.max||"∞")},t))})),e.push(c({property:"setup-cost",label:"Einrichtungskosten"},t),c({property:"film-cost",label:"Filmkosten"},t)),e},prices:function(){return this.product.prices||[]},quantities:function(){var t=[];return this.prices.forEach((function(e){return t.push({id:e.id,min:e.quantityStart,max:e.quantityEnd})})),t},extraCosts:function(){var t;return JSON.parse((null===(t=this.product.extensions.extraCostsExtension)||void 0===t?void 0:t.json)||"[]")},productRepository:function(){return this.repositoryFactory.create("product")},propertyGroupRepository:function(){return this.repositoryFactory.create("property_group")},extraCostRepository:function(){return this.repositoryFactory.create("hmnet_extracosts_extension")}},m("swProductDetail",["product","loading"])),y("swProductDetail",["isChild"])),watch:{product:function(t,e){t.id!==e.id&&this.setProperties()}},mounted:function(){this.mountedComponent()},methods:{mountedComponent:function(){this.setProperties()},setProperties:function(){var t,e=this;if(this.extraCosts&&this.extraCosts.length>0)return this.properties=this.extraCosts;null===(t=this.product.configuratorSettings)||void 0===t||t.forEach((function(t,r){var n=t.option,o={"setup-cost":0,"film-cost":0};e.quantities.forEach((function(t){return o[t.id]=0})),"7e0dcacf7f3d4d039de8ec33ede83181"!==n.groupId&&e.properties.push({id:String(r),name:n.groupId,value:n.name,prices:o,groupId:n.groupId})})),this.addPropertyGroupNames(),this.properties.sort((function(t,e){return t.name>e.name?1:-1}))},onInputChange:function(){this.save()},save:function(){var t,e=this.product.extensions.extraCostsExtension;return e&&0!==(null===(t=e)||void 0===t?void 0:t.length)||((e=this.extraCostRepository.create(d.api)).productId=this.product.id),e.json=JSON.stringify(this.properties),this.extraCostRepository.save(e,d.api),e},addPropertyGroupNames:function(){var t=this,e=new l,r=this.properties.map((function(t){return t.groupId}));e.setIds(r),this.propertyGroupRepository.search(e,d.api).then((function(e){t.properties=t.properties.map((function(t){var r=e.find((function(e){return e.id===t.groupId}));return t.name=r.name,t}))}))}}}),Shopware.Module.register("sw-new-tab-extracosts",{routeMiddleware:function(t,e){"sw.product.detail"===e.name&&e.children.push({name:"sw.product.detail.extracosts",path:"/sw/product/detail/:id/extracosts",component:"sw-product-detail-extracosts",meta:{parentPath:"sw.product.index"}}),t(e)}})}});